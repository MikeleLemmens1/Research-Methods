%==============================================================================
% Paper Research Methods: onderzoeksvoorstel
%==============================================================================

\documentclass{hogent-article}

\usepackage{lipsum} % Voor vultekst
\usepackage[backend=biber]{biblatex} 

% Invoegen bibliografiebestand
\addbibresource{LemmensMikele2024RM.bib}

% Informatie over de opleiding, het vak en soort opdracht
\studyprogramme{Professionele bachelor toegepaste informatica}
\course{Research Methods}
\assignmenttype{Paper: Onderzoeksvoorstel}
\academicyear{2023-2024}

\title{Optimalisatie van het voorstellen van recepten op basis van gebruikersvoorkeuren}

\author{Mikele Lemmens}
\email{Mikele.lemmens@student.hogent.be}

\projectrepo{https://github.com/hogenttin/rm-2324-lemmensmikele}

\specialisation{AI \& Data Engineering}

\keywords{recept voorstellen, voorkeur voeding, ingrediënt matching}

\begin{document}

\begin{abstract}
    
Een dagelijkse warme maaltijd is een belangrijk deel van een evenwichtig eetpatroon. In deze studie wordt een toepassing ontwikkeld die een relevant recept voorstelt aan een gebruiker die hulp wil bij het bedenken ervan en belang hecht aan een gezonde eetgewoonte. Er wordt geen gebruik gemaakt van taalmodellen om een bereidingswijze te genereren, maar wel van een dataset van bestaande hoofdgerechten. Het selecteren hiervan maakt ook deel uit van het onderzoek.

De relevantie van een gerecht wordt bepaald op basis van een kwantitatieve waarderingsscore die de gebruiker aan voorgestelde gerechten geeft. Er worden twee technieken gecombineerd; In de eerste wordt een lijst van ingrediënten opgesteld die voorkomen in een dataset van recepten uit verschillende categorieën. Voor die verzameling wordt een score berekend die een maat is voor hoe goed de elementen bij elkaar passen. Hoe hoger de score, hoe groter de kans dat een gevonden recept bestaande uit deze ingrediënten een goede waardering krijgt. De gebruiker geeft een gewenst ingrediënt in waarna een viertal andere worden aangevuld door de toepassing.

De tweede techniek berekent een waarde die aangeeft in hoeverre een reeks gerechten die op opeenvolgende dagen (zouden) worden klaargemaakt aan elkaar verwant zijn. Hoe lager deze score, hoe meer variëteit tussen de gerechten. Er wordt verwacht dat een grotere variatie gecorreleerd is met de waardering die elk recept in de reeks krijgt wanneer deze worden aangereikt. De recepten zijn geselecteerd op basis van de eerder gegenereerde ingrediëntenlijst en een gekozen categorie.

Het verwachte resultaat is dat de waardering van voorgestelde maaltijden m.b.v. de beschreven werkwijze hoger is dan diegene die voortkomt uit een receptenlijst opgesteld door een eenvoudige zoekopdracht met sleutelwoorden. Het gebruik van deze toepassing dient zo te zorgen voor een aangenamere kookervaring, aangepast aan de gebruiker en zonder de noodzaak om zelf een hoofdgerecht te bedenken.


\end{abstract}

\tableofcontents

\bigskip

% TODO: Neem je dit jaar ook de bachelorproef op? Haal dan de tekst hieronder
% uit commentaar en pas aan voor jouw situatie.

%\paragraph{Opmerking}

% Ik neem dit jaar ook de bachelorproef op. De inhoud van dit onderzoeksvoorstel dient ook als het onderwerpvoor mijn bachelorproef. Mijn promotor is (Mr./Mevr.) X.\ Familienaam.

% TODO: Beschrijf de eventuele verschillen en/of verbeteringen in dit document t.o.v.\ jouw onderzoeksvoorstel dat je ingediend hebt voor de bachelorproef.

\section{Inleiding}%
\label{sec:inleiding}

% TODO: (fase 1 - onderzoeksvraag formuleren)

Een dagelijkse warme maaltijd hoort bij een gezond eetpatroon volgens\cite{Galle2016}. Het is een meerwaarde om te kunnen worden geholpen door een toepassing die één of meerdere gerechten kan voorstellen, zodoende je niet steeds zelf een maaltijd hoeft te bedenken. Er zijn tal van kookboeken, websites en andere bronnen waarop je kan kiezen wat je wil klaarmaken. Ook worden er steeds meer toepassingen ontwikkeld die NLP gebruiken om recepten zelf te bedenken, bereidingswijzen te destilleren uit een foto, het samenstellen van een dieet naargelang voedingswaarden, enz. Het slagen van deze technieken is afhankelijk van hoe sterk een maaltijd wordt gewaardeerd, wat op zijn beurt afhangt van (historische) persoonlijke voorkeuren die onvoldoende in rekening worden gebracht.

In dit onderzoek wordt een proefopstelling ontwikkeld die na een ingevoerd ingrediënt aanvult met andere passende ingrediënten. Deze lijst wordt gebruikt om recepten op te zoeken in een databank. Bij uitbreiding kunnen meerdere recepten worden gekozen als weekmenu, waarbij een techniek wordt gebruikt die ervoor zorgt dat er voldoende variatie tussen de maaltijden is. Het gebruik van deze technieken, samen met een zelf opgemaakte databank en het bijhouden van een waardering per gebruiker maken de voorgestelde gerechten relevant. We richten ons op Belgen die dagelijks een warme maaltijd klaarmaken en hiervoor gebruik maken van een digitaal hulpmiddel om recepten op te zoeken. 

De volgende bijdragen worden geleverd:
\begin{itemize}
    \item een databank met alle Nederlandstalige recepten van een aantal Belgische kookwebsites wordt opgemaakt
    \item voor een gegeven startingrediënt wordt per categorie een lijst van best passende ingrediënten opgesteld
    \item deze lijst wordt gebruikt om recepten voor te stellen uit de databank
    \item na het opstellen van max. 5 ingrediëntenlijsten wordt een menu voor meerdere dagen voorgesteld, waarbij wordt rekening gehouden met de variëteit
\end{itemize}

\section{Literatuurstudie}%
\label{sec:literatuurstudie}

% TODO: (fase 3, 4 - literatuurstudie)

Hier beschrijf je de \emph{state-of-the-art} rondom je gekozen onderzoeksdomein, d.w.z.\ een inleidende, doorlopende tekst over het onderzoeksdomein van je bachelorproef. Je steunt daarbij heel sterk op de professionele \emph{vakliteratuur}, en niet zozeer op populariserende teksten voor een breed publiek. Wat is de huidige stand van zaken in dit domein, en wat zijn nog eventuele open vragen (die misschien de aanleiding waren tot je onderzoeksvraag!)? 

Je mag deze sectie nog verder onderverdelen in subsecties als dit de structuur van de tekst kan verduidelijken.

Zijn er al gelijkaardige onderzoeken gevoerd? Wat concluderen ze? Wat is het verschil met jouw onderzoek?

Verwijs bij elke introductie van een term of bewering over het domein naar de vakliteratuur! Denk zeker goed na welke werken je refereert en waarom.

Draag zorg voor correcte literatuurverwijzingen! Een bronvermelding hoort thuis \emph{binnen} de zin waar je je op die bron baseert, dus niet er buiten, bijvoorbeeld~\autocite{Hykes2013}! Maak meteen een verwijzing als je gebruik maakt van een bron. Doe dit dus \emph{niet} aan het einde van een lange paragraaf. Baseer nooit teveel aansluitende tekst op eenzelfde bron.

Als je informatie over bronnen verzamelt in JabRef, zorg er dan voor dat alle nodige info aanwezig is om de bron terug te vinden (zoals uitvoerig besproken in de lessen Research Methods).

% Refereren naar de literatuur kan met:
% \autocite{BIBTEXKEY} => (Auteur, jaartal): voor een referentie tussen
% haakjes, waar de auteursnaam GEEN onderdeel is van een zin.
% \textcite{BIBTEXKEY} => Auteur (jaartal): voor een narratieve referentie,
% waar de naam van de auteur effectief een onderdeel is van de zin.

\section{Methodologie}%
\label{sec:methodologie}

% TODO: (fase 5 - methodologie)

Het onderzoek bestaat uit verschillende fasen:
\begin{itemize}
    \item het creëren van de databank
    \item uitwerken van het proces om ingrediënten te matchen
    \item implementatie van het zoeken van 1 recept
    \item implementatie van het combineren van meerdere recepten
\end{itemize}

\subsection{Databank}%

Er wordt gestart met het opzetten en vullen van de databank waarin gerechten later worden opgezocht. Het genereren van bereidingen m.b.v. LLM is een vakgebied op zich en valt buiten de scope van dit onderzoek. Er bestaan reeds een groot aantal datasets, maar omdat we de zoekresultaten willen afstemmen op de gebruiker verkiezen we om de recepten van Nederlandstalige websites te scrapen. Dit maakt dat de meeste recepten niet ver afwijken van onze eetcultuur, wat ze gepaster maakt en de kans vergroot dat alle ingrediënten makkelijk aangekocht kunnen worden. De gebruiker zou ter uitbreiding websites kunnen selecteren als bron.

Recepten dienen opgeslagen te worden met volgende eigenschappen: titel, waardering, ingrediënten (met elk een naam, hoeveelheid en eenheid), een afbeelding, bereidingswijze, aantal personen, categorieën en bron. Omwille van de geneste attributen is JSON een handige notatie om de recepten op te slaan. Een primaire sleutel als identificatie per recept en per ingrediënt wordt toegevoegd om performant te kunnen opzoeken in de databank.


We nemen 2 willekeurige Belgische websites als proef en zoeken naar de HTML-tags waarin de door ons gezochte inhoud zit. In beide gevallen zijn de recepten zodanig gestructureerd dat de gewenste inhoud snel terug te vinden is a.d.h.v. duidelijke klassen (zoals recipe-content\_body) voor de bereidingswijze op een van de sites. Met de python bibliotheek Beautiful Soup kan de DOM-tree van een website worden overlopen om rauwe data te destilleren. De URL's van de pagina's die gescrapet moeten worden zijn te vinden in de sitemap (indien toegankelijk).  Er dienen nog enkele bewerkingen te gebeuren op de verzamelde data: de categorieën moeten bijgehouden worden bij het recept en de ingrediënten moeten zodanig worden aangepast dat verschillende schrijfwijzen worden gemapt op 1 ingrediënt (tomaten en tomaatjes moeten geïdentificeerd worden als tomaat). Dezelfde techniek kan worden toegepast wanneer de gebruiker een ingrediënt invoert.
De gerechten moeten worden onderverdeeld in categorieën. Dit is nodig om later voor een ingrediënt de best passende andere ingrediënten te vinden (deze score wordt berekend binnen een categorie, en een andere categorie geeft andere ingrediënten als best passend). De volgende categorieën zijn van toepassing: vlees, vis, gevogelte, wild, vegetarisch, salade, pasta, ovenschotel. Deze lijst kan worden uitgebreid en ieder recept kan in verschillende categorieën worden opgenomen. Hoe meer recepten er in zo'n categorie thuishoren, hoe accurater de typicaliteitsscore later kan worden berekend zonder in te boeten op variatie. Gerechten die niet kunnen worden onderverdeeld in een van deze categorieën (mogelijks ontbreekt er een onderverdeling op de bronwebsite) worden verzameld in een algemene categorie (“hoofdgerecht”). Deze recepten kunnen bij uitbreiding nog gecategoriseerd worden (door bv. te zoeken naar sleutelwoorden zoals “pasta, kip,…”) ter onderhoud van de toepassing.
Een ingrediënt moet worden getransformeerd zodat de gebruikte ingrediënten uniek terug te vinden zijn in onze ingrediëntentabel. Een nuttige techniek die kan worden toegepast is beschreven door S. Chaudhuri et al. (2003) en heet “fuzzy matching”.  

Deze techniek vergelijkt een nieuw ingrediënt met de reeds (in enkelvoud) opgeslagen ingrediënten. Er zijn 2 parameters die de performantie beïnvloeden: de grenswaarde en similariteitsfunctie. Deze laatste berekent een score die aangeeft hoe verwant 2 woorden zijn. Wanneer deze score boven een bepaalde grenswaarde valt spreken we van een match. Het nieuwe ingrediënt wordt in dat geval vervangen door de naam van het eerder opgeslagen ingrediënt. Voor twijfelgevallen over de juiste transformatie (“spruit” matcht even goed met “druif” als met “pruim” wanneer we Levenstein distance () nemen als functie) wordt er gebruik gemaakt van een logbestand om gericht te kunnen debuggen. Het kan interessant zijn om een bepaald interval in te stellen waarin alle twijfelgevallen moeten worden beoordeeld om zo de ideale grenswaarde te vinden.

Op deze moment hebben we een aantal recepten, voorzien van een titel, foto, ingrediëntenlijst en bereidingswijze. Ze zijn voorzien van één of meerdere categorieën. De ingrediënten die terug te vinden zijn in de receptenlijst zijn getransformeerd naar een uniek ingrediënt uit de ingrediëntentabel waarnaar in het recept wordt verwezen met een vreemde sleutel. Voor de bereidingswijze kan er worden gewerkt met een stappenplan, maar in de scope van dit onderzoek wordt deze als volle tekst gebruikt zoals ze van de site wordt gehaald. Indien de website de bereiding toch onderverdeeld worden alle onderdelen samengevoegd tot 1 veld om compatibel te zijn met de databank.

\subsection{Ingredient matching}%

Voor de volgende stap worden alle recepten onderverdeeld per categorie. Iedere categorie heeft bepaalde ingrediënten die typerend zijn. We willen een score toewijzen aan een set van ingrediënten voor een bepaalde categorie die verhoogt naarmate de combinatie van ingrediënten erbinnen vaak voorkomt. De werkwijze die wordt gehanteerd is beschreven door S.Yokoi (cite).

Ieder recept heeft een overeenstemmende vector die aanduid waaruit het bestaat. Deze heeft een lengte gelijk aan het aantal verschillende ingrediënten in de databank en de aan- of afwezigheid van een ingrediënt wordt aangeduid met resp. 1 of 0. Al deze vectoren worden samengevoegd tot een matrix met  corresponderende eigenruimte (de numpy-bibliotheek Linear Algebra bevat een methode om deze te berekenen in python). De typicaliteitsscore van een nieuwe ingrediëntvector is de L2-norm van de genormaliseerde projectie op de eigenruimte. De waarde ligt tussen 0 en 1 en een hogere waarde wijst erop dat de ingrediënten sterk vertegenwoordigd zijn binnen de categorie. Tot slot implementeren we een manier om de gebruikersvoorkeuren te laten meespelen. Hiervoor meten we hoe vaak een ingrediënt voorkomt in eerder klaargemaakte bereidingen, waarbij diegene die nog niet gebruikt zijn niet in rekening worden gebracht. De typicaliteitsscore wordt verzwaard met het gemiddelde van deze verhoudingen, om de uiteindelijke score te verkrijgen.

Het is deze score die moet worden geoptimaliseerd om een goede match te krijgen. Er moeten verschillende combinaties van 4 ingrediënten worden uitgeprobeerd (waarin datgene aangegeven door de gebruiker steeds is ingevuld) totdat een vastgelegde grenswaarde is overschreden. Dit garandeert ons dat niet 1 beste match steeds naar voor komt maar een groep waaruit werd gekozen. De input wordt gebruikt als seed, de overige 3 elementen van de rij worden willekeurig geïnitialiseerd, om vervolgens 1 voor 1 te worden vervangen door een willekeurig ander element uit de ongebruikte verzameling. 

\subsection{Recepten voorstellen}%

In het vorige onderdeel zijn we gestart van 1 ingrediënt dat de gebruiker invoert om een verzameling van 4 stuks te verkrijgen. Omdat alle ingrediënten in de eerste stap zijn omgevormd naar een referentie kan op basis van deze referentie een opzoeking gebeuren in de databank. Het is niet nodig om ook de bereidingsstappen te doorzoeken aangezien de sleutelwoorden waarop we zoeken allemaal te vinden zijn in de ingrediëntenlijst van een recept. In dit stadium zijn er verschillende mogelijke uitkomsten als uitvoer:

\begin{itemize}
    \item Er wordt 1 gerecht geretourneerd
    \item Er wordt een gerecht geretourneerd van iedere categorie waaruit 1 wordt geselecteerd door de gebruiker
    \item Er wordt een gekozen aantal gerechten voorgesteld als weekmenu
\end{itemize}

In het eerste geval hebben we als uitkomst van stap 2 een ingrediëntenlijst per categorie. Doordat de lijst voortkomt uit een groep van matches zijn kan de match met de hoogste score worden gekozen zonder dat dit steeds hetzelfde resultaat geeft. Een alternatieve strategie is dat er geen keuze wordt gemaakt door het systeem, maar dat alle categorieën worden vertegenwoordigd door 1 zoekresultaat waarna de gebruiker één selecteert.
Beide opties geven geen meerwaarde tegenover een klassieke zoekopdracht, behalve dat de opzoeking kwalitatieve beperkingen respecteert die relevante suggesties voortbrengen. Om die reden wordt er in de toepassing een functionaliteit toegevoegd die de resultaten uitbreidt; Bij een geselecteerd gerecht worden er een gekozen aantal bereidingen toegevoegd om zo een weekmenu tot stand te brengen. Dit menu bestaat uit een gekozen aantal recepten en een chronologische volgorde die stelt welk gerecht op welke dag wordt klaargemaakt. Om ervoor te zorgen dat er voldoende variatie is willen we aan de combinatie van deze gerechten een score toewijzen die aangeeft in hoeverre ze verschillen van elkaar. Een hogere score betekent veel variatie, en dat is wenselijk in een gezond eetpatroon. De methode die we gebruiken is een implementatie beschreven door Ueda et al. Naar analogie met de typicaliteitsscore krijgt ieder recept een score die gebruikersvoorkeuren in rekening brengt. Ingrediënten die vaak voorkomen in de lijst van bereidingen die de gebruiker eerder heeft klaargemaakt verhogen de score, terwijl deze die voorkomen in de lijst van ongewenste maaltijden de score verlagen. De voorkomens worden gekwantificeerd op basis van TF-IDF. Deze intrinsieke score wordt verminderd met een gewogen score die een maat is voor de (tekstuele) gelijkenis tussen 2 gerechten. Het gewicht neemt af naarmate de gerechten verder van elkaar liggen in de tijd.
Door de scores op te tellen bekomen we een maat voor de variatie die nog steeds rekening houdt met gebruikersvoorkeuren. Deze score kan worden geoptimaliseerd op 2 manieren: ofwel wordt het beste volgende gerecht iteratief aan het menu toegevoegd tot het gewenste aantal is bereikt, ofwel worden alle mogelijke combinaties uit de eerder gevonden bereidingen gecombineerd en blijft de combinatie met de hoogste score behouden. We beperken ons tot het opstellen van een weekmenu met max. 5 maaltijden met 2 voorgestelde gerechten per categorie om de bewerkingstijd te beperken.

\section{Verwachte resultaten}%
\label{sec:verwachte-resultaten}

% TODO: (fase 6 - afwerking)

Hier beschrijf je welke resultaten je verwacht en waarom. Bijvoorbeeld, volgens je literatuuronderzoek is softwarepakket A het meest gebruikte en dus denk je dat het voor deze casus ook het meest geschikt zal zijn. Natuurlijk kan je niet in de toekomst kijken en mag je geen alternatieve mogelijkheden uitsluiten.

Als je experimenten, simulaties of metingen uitvoert, kan je overwegen om een mock-up te maken van een grafiek van de uitkomst die je vermoed. Benoem zeker al je assen en meeteenheden die je gaat gebruiken. Hierdoor krijg je ook een concreet beeld van het soort data je zal moeten verzamelen. Pas hierbij toe wat je in Data Science \& AI geleerd hebt over visualisatie van data en toepassen van correcte statistische technieken.

\section{Discussie, verwachte conclusie}%
\label{sec:discussie-conclusie}

Wat heeft de doelgroep van je onderzoek aan het resultaat? Op welke manier biedt jouw onderzoek een meerwaarde?

Het is \textbf{niet} erg indien uit je onderzoek andere resultaten en conclusies vloeien dan dat je hier beschrijft: het is dan juist interessant om te onderzoeken waarom jouw hypothesen niet overeenkomen met de resultaten.

Als je onderwerp zich daartoe leent, kan je eventueel ook suggesties doen voor een vervolg, hetzij verder onderzoek, hetzij verder bouwen op een PoC of prototype tot een eindproduct, hetzij mogelijkheden om de resultaten te valoriseren of commercialiseren.

%------------------------------------------------------------------------------
% Referentielijst
%------------------------------------------------------------------------------
% TODO: (fase 4) de gerefereerde werken moeten in BibTeX-bestand
% bibliografie.bib voorkomen. Gebruik JabRef om je bibliografie bij te
% houden.

%\printbibliography[heading=bibintoc, title={References}] 

\end{document}